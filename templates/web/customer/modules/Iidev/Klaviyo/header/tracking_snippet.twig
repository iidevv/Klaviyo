<script src="https://static.klaviyo.com/onsite/js/klaviyo.js?company_id={{this.getPublicKey()}}"></script>

{% if this.getLogin() and not this.isUserIdentified() %}
<script>
    window.klaviyoLayer = {
        type: "identify",
        data: "{{this.getLogin()}}"
    };
</script>
{{this.setUserIdentity()}}

{% endif %}

{% if this.isProductPage() %}
<script>
    window.klaviyoLayer = {
        type: "product",
        data: {{this.getProductPageData()|json_encode()|raw}}
    };
</script>
{% endif %}

{% if this.isCheckoutPage() %}
<script>
    window.klaviyoLayer = {
        type: "checkout",
        data: {{this.getCheckoutPageData()|json_encode()|raw}}
    };
</script>
{% endif %}
